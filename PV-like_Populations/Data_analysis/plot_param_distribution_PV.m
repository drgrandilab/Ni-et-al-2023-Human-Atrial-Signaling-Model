
clear;close all;

% index = 1+[148, 224, 330, 369, 435, 460, 535, 620, 693, 717, 763, 892, 1031, 1150, 1169, 1223, 1298, 1340, 1424, 1472, 1484, 1644, 1734, 1755, 1801, 1849, 1951, 1978, 2079, 2102, 2127, 2193, 2259, 2285, 2435, 2452, 2462, 2530, 2558, 2593, 2629, 2699, 2721, 2801, 2861, 2874, 3038, 3081, 3110, 3132, 3259, 3404, 3504, 3519, 3570, 3673, 3737, 3741, 3800, 3860, 3950, 4002, 4135, 4213, 4341, 4374, 4581, 4609, 4675, 4693, 4711, 4738, 4833, 4880, 4940, 4980, 4984, 5240, 5303, 5308, 5346, 5400, 5401, 5486, 5515, 5627, 5631, 5699, 5779, 5802, 5862, 6058, 6059, 6173, 6185, 6195, 6288, 6390, 6420, 6464, 6479, 6493, 6519, 6550, 6628, 6721, 6909, 6992, 7120, 7173, 7249, 7308, 7359, 7435, 7507, 7528, 7574, 7752, 7841, 7926, 7988, 7994, 8052, 8055, 8107, 8217, 8226, 8244, 8249, 8376, 8420, 8489, 8862, 8868, 9096, 9258, 9271, 9293, 9345, 9346, 9348, 9448, 9674, 9738, 9788, 9857, 9981, 10067, 10105, 10248, 10426, 10427, 10463, 10474, 10541, 10582, 10628, 10707, 10775, 10842, 10858, 10872, 11090, 11130, 11131, 11273, 11317, 11318, 11338, 11347, 11468, 11536, 11569, 11618, 11620, 11629, 11651, 11658, 11670, 11726, 11749, 12008, 12040, 12241, 12416, 12442, 12598, 12646, 12981, 13075, 13106, 13130, 13189, 13190, 13372, 13456, 13687, 13711, 13820, 13989, 14060, 14095, 14113, 14179, 14210, 14231, 14270, 14441, 14475, 14601, 14694, 14764, 14849, 14874, 14971, 14974, 15003, 15249, 15471, 15499, 15548, 15552, 15602, 15697, 15800, 15823, 15855, 15910, 15945, 15985, 16004, 16011, 16140, 16266, 16267, 16285, 16401, 16435, 16436, 16448, 16815, 16833, 16943, 17010, 17043, 17063, 17226, 17239, 17280, 17285, 17437, 17438, 17461, 17478, 17517, 17661, 17744, 17782, 17891, 18093, 18103, 18185, 18201, 18224, 18225, 18237, 18244, 18288, 18350, 18408, 18438, 18463, 18502, 18543, 18547, 18561, 18697, 18747, 18768, 18787, 19006, 19072, 19138, 19181, 19198, 19203, 19261, 19329, 19433, 19452, 19482, 19692, 19818, 19836, 19930, 19969];
% index = 1+[148, 224, 239, 330, 369, 435, 460, 526, 533, 535, 620, 693, 717, 763, 892, 1031, 1125, 1142, 1150, 1158, 1169, 1197, 1223, 1235, 1242, 1298, 1340, 1424, 1472, 1484, 1523, 1644, 1734, 1745, 1755, 1801, 1849, 1890, 1951, 1978, 2079, 2102, 2127, 2193, 2259, 2285, 2400, 2435, 2445, 2452, 2462, 2530, 2558, 2593, 2596, 2629, 2699, 2721, 2801, 2861, 2874, 2964, 3038, 3051, 3081, 3096, 3110, 3132, 3259, 3262, 3404, 3457, 3499, 3504, 3519, 3570, 3673, 3679, 3680, 3737, 3741, 3769, 3800, 3860, 3950, 4002, 4135, 4138, 4164, 4192, 4198, 4207, 4213, 4272, 4341, 4374, 4500, 4526, 4581, 4609, 4614, 4675, 4693, 4711, 4738, 4750, 4799, 4833, 4880, 4940, 4980, 4984, 5240, 5303, 5308, 5346, 5400, 5401, 5486, 5515, 5561, 5627, 5631, 5699, 5779, 5799, 5802, 5809, 5862, 5997, 6058, 6059, 6173, 6185, 6195, 6210, 6241, 6288, 6304, 6390, 6420, 6464, 6479, 6493, 6519, 6550, 6570, 6575, 6628, 6721, 6887, 6909, 6992, 7069, 7076, 7091, 7120, 7135, 7173, 7249, 7305, 7308, 7359, 7409, 7435, 7436, 7507, 7512, 7514, 7528, 7574, 7752, 7812, 7841, 7867, 7926, 7988, 7994, 8052, 8055, 8057, 8107, 8156, 8217, 8225, 8226, 8244, 8249, 8376, 8420, 8430, 8489, 8552, 8601, 8758, 8862, 8868, 8986, 9096, 9112, 9198, 9258, 9271, 9293, 9345, 9346, 9348, 9351, 9357, 9395, 9401, 9448, 9569, 9674, 9682, 9738, 9788, 9857, 9981, 10067, 10105, 10159, 10236, 10248, 10371, 10412, 10426, 10427, 10463, 10474, 10507, 10541, 10582, 10628, 10681, 10707, 10775, 10842, 10847, 10858, 10872, 11067, 11090, 11130, 11131, 11149, 11196, 11240, 11273, 11317, 11318, 11332, 11338, 11347, 11434, 11468, 11536, 11557, 11569, 11572, 11618, 11620, 11629, 11651, 11657, 11658, 11670, 11726, 11749, 11843, 12008, 12040, 12061, 12107, 12126, 12222, 12241, 12416, 12442, 12575, 12598, 12646, 12761, 12966, 12981, 12992, 13072, 13075, 13098, 13106, 13130, 13160, 13189, 13190, 13372, 13456, 13470, 13574, 13687, 13711, 13749, 13787, 13820, 13984, 13989, 14060, 14095, 14113, 14152, 14179, 14189, 14210, 14231, 14270, 14441, 14475, 14601, 14694, 14718, 14764, 14849, 14874, 14971, 14974, 15003, 15249, 15262, 15471, 15499, 15548, 15552, 15586, 15602, 15667, 15681, 15690, 15697, 15703, 15800, 15823, 15855, 15910, 15945, 15985, 16004, 16011, 16140, 16266, 16267, 16285, 16401, 16435, 16436, 16448, 16503, 16509, 16630, 16706, 16709, 16803, 16815, 16833, 16943, 16954, 17010, 17039, 17043, 17063, 17144, 17205, 17226, 17239, 17280, 17285, 17373, 17426, 17437, 17438, 17461, 17478, 17517, 17526, 17612, 17642, 17661, 17686, 17744, 17782, 17799, 17891, 17937, 17972, 18005, 18093, 18103, 18185, 18201, 18224, 18225, 18237, 18244, 18288, 18350, 18408, 18421, 18438, 18459, 18463, 18479, 18502, 18543, 18547, 18555, 18561, 18615, 18616, 18697, 18747, 18768, 18787, 18796, 18800, 19006, 19051, 19072, 19132, 19138, 19181, 19198, 19203, 19212, 19261, 19329, 19358, 19433, 19452, 19482, 19579, 19674, 19692, 19818, 19823, 19836, 19930, 19960, 19969];
% index = 1+ [148, 224, 330, 369, 435, 460, 535, 620, 693, 717, 763, 892, 1031, 1150, 1169, 1223, 1298, 1340, 1424, 1472, 1484, 1644, 1734, 1755, 1801, 1849, 1951, 1978, 2079, 2102, 2127, 2193, 2259, 2285, 2435, 2452, 2462, 2530, 2558, 2593, 2629, 2699, 2721, 2801, 2861, 2874, 3038, 3081, 3110, 3132, 3259, 3404, 3504, 3519, 3570, 3673, 3737, 3741, 3800, 3860, 3950, 4002, 4135, 4213, 4341, 4374, 4581, 4609, 4675, 4693, 4711, 4738, 4833, 4880, 4940, 4980, 4984, 5240, 5303, 5308, 5346, 5400, 5401, 5486, 5515, 5627, 5631, 5699, 5779, 5802, 5862, 6058, 6059, 6173, 6185, 6195, 6288, 6390, 6420, 6464, 6479, 6493, 6519, 6550, 6628, 6721, 6909, 6992, 7120, 7173, 7249, 7308, 7359, 7435, 7507, 7528, 7574, 7752, 7841, 7926, 7988, 7994, 8052, 8055, 8107, 8217, 8226, 8244, 8249, 8376, 8420, 8489, 8862, 8868, 9096, 9258, 9271, 9293, 9345, 9346, 9348, 9448, 9674, 9738, 9788, 9857, 9981, 10067, 10105, 10248, 10426, 10427, 10463, 10474, 10541, 10582, 10628, 10707, 10775, 10842, 10858, 10872, 11090, 11130, 11131, 11273, 11317, 11318, 11338, 11347, 11468, 11536, 11569, 11618, 11620, 11629, 11651, 11658, 11670, 11726, 11749, 12008, 12040, 12241, 12416, 12442, 12598, 12646, 12981, 13075, 13106, 13130, 13189, 13190, 13372, 13456, 13687, 13711, 13820, 13989, 14060, 14095, 14113, 14179, 14210, 14231, 14270, 14441, 14475, 14601, 14694, 14764, 14849, 14874, 14971, 14974, 15003, 15249, 15471, 15499, 15548, 15552, 15602, 15697, 15800, 15823, 15855, 15910, 15945, 15985, 16004, 16011, 16140, 16266, 16267, 16285, 16401, 16435, 16436, 16448, 16815, 16833, 16943, 17010, 17043, 17063, 17226, 17239, 17280, 17285, 17437, 17438, 17461, 17478, 17517, 17661, 17744, 17782, 17891, 18093, 18103, 18185, 18201, 18224, 18225, 18237, 18244, 18288, 18350, 18408, 18438, 18463, 18502, 18543, 18547, 18561, 18697, 18747, 18768, 18787, 19006, 19072, 19138, 19181, 19198, 19203, 19261, 19329, 19433, 19452, 19482, 19692, 19818, 19836, 19930, 19969];
index = 1+ [148, 330, 435, 460, 535, 1031, 1223, 1734, 1951, 1978, 2079, 2102, 2285, 2435, 2452, 2558, 2629, 2721, 2874, 3259, 3404, 3570, 3737, 3950, 4135, 4213, 4581, 4711, 4880, 5400, 5699, 6185, 6390, 6420, 6464, 6550, 6628, 6909, 6992, 7120, 7359, 7435, 7507, 7528, 7574, 7988, 8217, 8376, 8489, 8862, 9345, 9346, 9348, 9448, 9857, 10067, 10463, 10842, 11090, 11130, 11338, 11347, 11468, 11620, 12008, 13189, 13456, 14095, 14179, 14475, 14694, 14849, 14874, 15471, 15548, 15602, 15800, 15823, 16285, 16435, 16436, 16448, 16943, 17043, 17063, 17285, 17437, 17517, 17744, 18103, 18185, 18225, 18237, 18288, 18438, 18463, 18547, 18561, 18747, 18768, 19006, 19138, 19181, 19203, 19452, 19482, 19818, 19930];

% zero-indexed values transformed to matlab 1-indexed 
index = 1+[148, 224, 239, 330, 369, 435, 460, 526, 533, 535, 620, 693, 717, 763, 892, 1031, 1125, 1142, 1150, 1158, 1169, 1197, 1223, 1235, 1242, 1298, 1340, 1424, 1472, 1484, 1523, 1644, 1734, 1745, 1755, 1801, 1849, 1890, 1951, 1978, 2079, 2102, 2127, 2193, 2259, 2285, 2400, 2435, 2445, 2452, 2462, 2530, 2558, 2593, 2596, 2629, 2699, 2721, 2801, 2861, 2874, 2964, 3038, 3051, 3081, 3096, 3110, 3132, 3259, 3262, 3404, 3457, 3499, 3504, 3519, 3570, 3673, 3679, 3680, 3737, 3741, 3769, 3800, 3860, 3950, 4002, 4135, 4138, 4164, 4192, 4198, 4207, 4213, 4272, 4341, 4374, 4500, 4526, 4581, 4609, 4614, 4675, 4693, 4711, 4738, 4750, 4799, 4833, 4880, 4940, 4980, 4984, 5240, 5303, 5308, 5346, 5400, 5401, 5486, 5515, 5561, 5627, 5631, 5699, 5779, 5799, 5802, 5809, 5862, 5997, 6058, 6059, 6173, 6185, 6195, 6210, 6241, 6288, 6304, 6390, 6420, 6464, 6479, 6493, 6519, 6550, 6570, 6575, 6628, 6721, 6887, 6909, 6992, 7069, 7076, 7091, 7120, 7135, 7173, 7249, 7305, 7308, 7359, 7409, 7435, 7436, 7507, 7512, 7514, 7528, 7574, 7752, 7812, 7841, 7867, 7926, 7988, 7994, 8052, 8055, 8057, 8107, 8156, 8217, 8225, 8226, 8244, 8249, 8376, 8420, 8430, 8489, 8552, 8601, 8758, 8862, 8868, 8986, 9096, 9112, 9198, 9258, 9271, 9293, 9345, 9346, 9348, 9351, 9357, 9395, 9401, 9448, 9569, 9674, 9682, 9738, 9788, 9857, 9981, 10067, 10105, 10159, 10236, 10248, 10371, 10412, 10426, 10427, 10463, 10474, 10507, 10541, 10582, 10628, 10681, 10707, 10775, 10842, 10847, 10858, 10872, 11067, 11090, 11130, 11131, 11149, 11196, 11240, 11273, 11317, 11318, 11332, 11338, 11347, 11434, 11468, 11536, 11557, 11569, 11572, 11618, 11620, 11629, 11651, 11657, 11658, 11670, 11726, 11749, 11843, 12008, 12040, 12061, 12107, 12126, 12222, 12241, 12416, 12442, 12575, 12598, 12646, 12761, 12966, 12981, 12992, 13072, 13075, 13098, 13106, 13130, 13160, 13189, 13190, 13372, 13456, 13470, 13574, 13687, 13711, 13749, 13787, 13820, 13984, 13989, 14060, 14095, 14113, 14152, 14179, 14189, 14210, 14231, 14270, 14441, 14475, 14601, 14694, 14718, 14764, 14849, 14874, 14971, 14974, 15003, 15249, 15262, 15471, 15499, 15548, 15552, 15586, 15602, 15667, 15681, 15690, 15697, 15703, 15800, 15823, 15855, 15910, 15945, 15985, 16004, 16011, 16140, 16266, 16267, 16285, 16401, 16435, 16436, 16448, 16503, 16509, 16630, 16706, 16709, 16803, 16815, 16833, 16943, 16954, 17010, 17039, 17043, 17063, 17144, 17205, 17226, 17239, 17280, 17285, 17373, 17426, 17437, 17438, 17461, 17478, 17517, 17526, 17612, 17642, 17661, 17686, 17744, 17782, 17799, 17891, 17937, 17972, 18005, 18093, 18103, 18185, 18201, 18224, 18225, 18237, 18244, 18288, 18350, 18408, 18421, 18438, 18459, 18463, 18479, 18502, 18543, 18547, 18555, 18561, 18615, 18616, 18697, 18747, 18768, 18787, 18796, 18800, 19006, 19051, 19072, 19132, 19138, 19181, 19198, 19203, 19212, 19261, 19329, 19358, 19433, 19452, 19482, 19579, 19674, 19692, 19818, 19823, 19836, 19930, 19960, 19969]
parameter_names = [{'GNa'},{'GNaL'},{'GNaB'},{'VNaK'},{'Gto'},{'GKur'},{'GK2P'},{'GKr'},{'GKs'},{'GK1'},{'GKp'}, {'GKCa'},{'GCaL'},{'GCaB'}, ...
{'VPMCA'},{'VNCX'},{'GClCa'},{'GClB'},{'VRyR'},{'VSERCA'},{'VLeak'},{'Ca Buffer-Cleft'},{'Ca Buffer-Cyt'},{'Ca Buffer-SR'}];


d = load('params/para_large_sigma.log.20000');


paras = d(index, [1:11, 13:25]);
[XX, YY] = size(paras);

for i = 1:XX
	X(i,:) = 1:YY;
end

swarmchart(X,log(paras)); hold on;
boxplot(log(paras))
plot([0,25], [0,0], '--')
N_pars=24
set(gca,'XTick',1:N_pars)
set(gca,'XTickLabel',parameter_names)
set(gca,'box','off','tickdir','out','fontsize',12)
set(gca, 'XTickLabelRotation', 90)
ylim([-1.2,1.2])

for i =1:24
    para_name = parameter_names(i);
    [h,p]=ttest(log(paras(:,i)));

    p_rank = signrank(log(paras(:,i)));
    
    if(p*24<0.05)
    fprintf('%s, %e, %f, %f\n', para_name{1}, p*24, p_rank*24, p*24<0.05);
    end
end

close all;
figure(4)

indexes = [1,3,4,10,13,14,18,20,23]
plot([0,10], [0,0], '--','color','k'); hold on;
swarmchart(X(:,1:9),log(paras(:,indexes)), 18, [0.5,0.5,0.5], 'XJitterWidth',0.7,'MarkerEdgeAlpha',0.8); hold on;
boxplot(log(paras(:,indexes)),'symbol', '')

N_pars=9
set(gca,'XTick',1:N_pars)
set(gca,'XTickLabel',parameter_names(indexes))
set(gca,'box','off','tickdir','out','fontsize',18)
set(gca, 'XTickLabelRotation', 90)
ylim([-1.,1.])
xlim([0,10])
